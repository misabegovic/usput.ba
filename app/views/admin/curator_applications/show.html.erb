<div class="space-y-6">
  <div class="sm:flex sm:items-center sm:justify-between">
    <h1 class="text-xl sm:text-2xl font-bold text-gray-900">
      <%= t("admin.curator_applications.application_from", username: @application.user.username) %>
    </h1>
    <div class="mt-3 sm:mt-0">
      <%= link_to t("admin.curator_applications.back_to_list"), admin_curator_applications_path,
          class: "inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" %>
    </div>
  </div>

  <!-- Status and Actions -->
  <div class="overflow-hidden rounded-lg bg-white shadow">
    <div class="px-4 py-4 sm:p-6">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div>
          <span class="text-sm text-gray-500"><%= t("admin.curator_applications.status_label") %>:</span>
          <% case @application.status %>
          <% when "pending" %>
            <span class="ml-2 inline-flex items-center rounded-full bg-yellow-100 px-3 py-1 text-sm font-medium text-yellow-800">
              <%= t("curator_applications.status.pending") %>
            </span>
          <% when "approved" %>
            <span class="ml-2 inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-sm font-medium text-green-800">
              <%= t("curator_applications.status.approved") %>
            </span>
          <% when "rejected" %>
            <span class="ml-2 inline-flex items-center rounded-full bg-red-100 px-3 py-1 text-sm font-medium text-red-800">
              <%= t("curator_applications.status.rejected") %>
            </span>
          <% end %>
        </div>

        <% if @application.pending? %>
          <div class="space-y-4">
            <!-- Admin Credentials for protected actions -->
            <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
              <p class="text-sm text-gray-600 mb-3">
                <%= t("admin.credentials.confirm_action", default: "Confirm your admin credentials to proceed:") %>
              </p>
              <div class="flex flex-col sm:flex-row gap-3" data-controller="admin-credentials">
                <input type="text"
                       id="curator_admin_username"
                       placeholder="<%= t("admin.credentials.username", default: "Admin Username") %>"
                       data-admin-credentials-target="username"
                       class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm">
                <input type="password"
                       id="curator_admin_password"
                       placeholder="<%= t("admin.credentials.password", default: "Admin Password") %>"
                       data-admin-credentials-target="password"
                       class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm">
              </div>
            </div>

            <div class="flex flex-col sm:flex-row gap-3">
              <%= form_with url: approve_admin_curator_application_path(@application), method: :post, class: "inline", data: { controller: "credential-form", "credential-form-username-id-value": "curator_admin_username", "credential-form-password-id-value": "curator_admin_password" } do |f| %>
                <%= f.hidden_field :admin_username, data: { "credential-form-target": "usernameField" } %>
                <%= f.hidden_field :admin_password, data: { "credential-form-target": "passwordField" } %>
                <%= f.submit t("admin.curator_applications.approve_btn"),
                    class: "inline-flex items-center justify-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 cursor-pointer",
                    data: { turbo_confirm: t("admin.curator_applications.confirm_approve", username: @application.user.username), action: "credential-form#copyCredentials" } %>
              <% end %>

              <%= form_with url: reject_admin_curator_application_path(@application), method: :post, class: "flex flex-col sm:flex-row items-stretch sm:items-center gap-2", data: { controller: "credential-form", "credential-form-username-id-value": "curator_admin_username", "credential-form-password-id-value": "curator_admin_password" } do |f| %>
                <%= f.hidden_field :admin_username, data: { "credential-form-target": "usernameField" } %>
                <%= f.hidden_field :admin_password, data: { "credential-form-target": "passwordField" } %>
                <%= f.text_field :admin_notes,
                    placeholder: t("admin.curator_applications.rejection_reason"),
                    class: "rounded-md border-gray-300 text-sm w-full" %>
                <%= f.submit t("admin.curator_applications.reject_btn"),
                    class: "inline-flex items-center justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 cursor-pointer",
                    data: { turbo_confirm: t("admin.curator_applications.confirm_reject", username: @application.user.username), action: "credential-form#copyCredentials" } %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>

      <% if @application.reviewed_by.present? %>
        <div class="mt-4 text-sm text-gray-500">
          <%= t("admin.curator_applications.reviewed_by",
              admin: @application.reviewed_by.username,
              date: @application.reviewed_at.strftime("%d.%m.%Y %H:%M")) %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Application Details -->
  <div class="overflow-hidden rounded-lg bg-white shadow">
    <div class="px-4 py-5 sm:p-6">
      <dl class="space-y-6">
        <div>
          <dt class="text-sm font-medium text-gray-500"><%= t("admin.curator_applications.submitted") %></dt>
          <dd class="mt-1 text-sm text-gray-900"><%= @application.created_at.strftime("%d.%m.%Y %H:%M") %></dd>
        </div>

        <div>
          <dt class="text-sm font-medium text-gray-500"><%= t("curator_applications.form.motivation") %></dt>
          <dd class="mt-1 text-sm text-gray-900 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg">
            <%= @application.motivation %>
          </dd>
        </div>

        <% if @application.experience.present? %>
          <div>
            <dt class="text-sm font-medium text-gray-500"><%= t("curator_applications.form.experience") %></dt>
            <dd class="mt-1 text-sm text-gray-900 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg">
              <%= @application.experience %>
            </dd>
          </div>
        <% end %>

        <% if @application.admin_notes.present? %>
          <div>
            <dt class="text-sm font-medium text-gray-500"><%= t("admin.curator_applications.admin_notes") %></dt>
            <dd class="mt-1 text-sm text-gray-900 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg">
              <%= @application.admin_notes %>
            </dd>
          </div>
        <% end %>
      </dl>
    </div>
  </div>

  <!-- User Info -->
  <div class="overflow-hidden rounded-lg bg-white shadow">
    <div class="px-4 py-4 sm:p-6">
      <h3 class="text-base sm:text-lg font-medium text-gray-900 mb-4"><%= t("admin.curator_applications.user_info") %></h3>
      <dl class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div>
          <dt class="text-sm font-medium text-gray-500"><%= t("admin.users.username") %></dt>
          <dd class="mt-1 text-sm text-gray-900"><%= @application.user.username %></dd>
        </div>
        <div>
          <dt class="text-sm font-medium text-gray-500"><%= t("admin.users.created_at") %></dt>
          <dd class="mt-1 text-sm text-gray-900"><%= @application.user.created_at.strftime("%d.%m.%Y") %></dd>
        </div>
        <div>
          <dt class="text-sm font-medium text-gray-500"><%= t("admin.users.type") %></dt>
          <dd class="mt-1 text-sm text-gray-900"><%= t("admin.users.types.#{@application.user.user_type}") %></dd>
        </div>
      </dl>
    </div>
  </div>
</div>
